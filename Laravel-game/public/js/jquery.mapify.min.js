/*
Mapify 1.3
The MIT License (MIT)
Copyright (c) 2014 etienne-martin
*/	
(function(f){var g={hoverClass:"",popOver:false};var b={hoverClass:"",popOver:{content:function(i,j){return""},delay:0.8,margin:"10px",width:"",height:""}};var c=false;if("ontouchstart" in document.documentElement&&"ontouchmove" in document.documentElement&&"ontouchend" in document.documentElement){c=true}var e=/(iPad|iPhone|iPod)/g.test(navigator.userAgent);f.fn.mapify=function(j){var j=f.extend(true,{},g,j);if(j.popOver){var j=f.extend(true,{},b,j);j.popOver.margin=parseInt(j.popOver.margin);j.popOver.width=j.popOver.width;var i="";var l="";if(!isNaN(j.popOver.delay)){i="all "+j.popOver.delay+"s";l="margin "+j.popOver.delay+"s"}}var k=this;k.each(function(){var A=this;var n=f(A).attr("usemap");var r=f(n).find("area");if(!f(A).hasClass("mapify")){var o=false;if(j.popOver){o=true}f(A).addClass("mapify");var v=parseInt(f(A).attr("width"));var x=parseInt(f(A).attr("height"));if(!f(A).attr("width")||!f(A).attr("height")){alert("The width and height attributes must be specified on your image.");return"Not mapified"}f(A).wrap(function(){return'<div class="mapify-holder"></div>'});var u=f(A).parent();f(n).appendTo(u);f(A).before('<img class="mapify-img" src="'+f(A).attr("src")+'" />');var p=f(A).prev(".mapify-img");f(A).before('<svg class="mapify-svg" width="'+v+'" height="'+x+'"></svg>');var z=f(A).prev(".mapify-svg");r.each(function(){f(this).attr("data-coords-default",f(this).attr("coords"));if(o){f(this).removeAttr("alt").attr("data-title",f(this).attr("title")).removeAttr("title")}var E=f(this).attr("coords").split(",");for(key in E){if(key%2==0){E[key]=E[key]*100/v}else{E[key]=E[key]*100/x}}f(this).attr("data-coords",E.toString());var D=document.createElementNS("http://www.w3.org/2000/svg","polygon");D.className="mapify-polygon";D.setAttribute("fill","none");z.append(D)});f(A).wrap(function(){return'<div class="mapify-imgHolder"></div>'}).css("opacity",0);if(o){f(A).after('<div class="mapify-popOver" style=" transition:'+i+'; "><div class="mapify-popOver-content"></div><div class="mapify-popOver-arrow" style=" transition:'+l+'; "></div></div>');var C=f(A).next(".mapify-popOver");var w=C.find(".mapify-popOver-arrow");C.css({width:j.popOver.width,height:j.popOver.height})}var t=false;f(document).bind("touchend.mapify",function(D){if(!t){y(C,z)}t=false}).bind("touchmove.mapify",function(D){t=true});f(A).bind("touchmove.mapify",function(D){});r.css({outline:"none"}).bind("touchend.mapify",function(D){if(f(this).hasClass("mapify-clickable")){f(this).trigger("click");r.removeClass("mapify-clickable")}t=false;D.stopPropagation()}).bind("click.mapify",function(D){if(D.originalEvent!==undefined&&c){return false}}).bind("touchstart.mapify",function(D){r.removeClass("mapify-clickable");if(z.find("polygon:eq("+f(this).index()+")")[0].classList.contains("mapify-hover")){f(this).addClass("mapify-clickable")}else{f(this).addClass("mapify-hilightable")}}).bind("touchmove.mapify",function(D){r.removeClass("mapify-clickable mapify-hilightable")}).bind("mouseenter.mapify focus.mapify touchend.mapify",function(E){var D=this;if(!f(this).hasClass("mapify-hilightable")&&c){return false}y(C,z);if(o){m(C,D)}h(D,A,z,j.hoverClass);E.preventDefault()}).bind("mouseout.mapify",function(){y(C,z)});if(!e){r.bind("blur.mapify",function(){y(C,z)})}var q;f(window).bind("resize.mapify",function(){q&&clearTimeout(q);q=setTimeout(function(){if(o){if(!C.hasClass("mapify-visible")){C.css({left:0,top:0})}}z.find("polygon").attr("points","");a(r,A);var D=r[z.find("polygon.mapify-hover").index()];if(D){if(o){m(C,D)}h(D,A,z,j.hoverClass)}},100)});var B=f(A).scrollParent();if(f(B).is(document)){B=f(window)}B.addClass("mapify-GPU");B.bind("scroll.mapify",function(){if(c){r.removeClass("mapify-clickable mapify-hilightable")}if(o){if(e){C.css({top:C.css("top"),left:C.css("left"),transition:"none"});w.css({marginLeft:w.css("margin-left"),transition:"none"})}clearTimeout(f.data(this,"scrollTimer"));f.data(this,"scrollTimer",setTimeout(function(){var D=r[z.find("polygon.mapify-hover").index()];if(D){m(C,D);if(e){C.css({top:corners[1],left:corners[0],transition:i});w.css({marginLeft:popOverArrowCompensation,transition:l})}}},100))}});console.log("mapified");var s;function y(D,E){if(o){clearTimeout(s);s=setTimeout(function(){D.removeClass("mapify-visible")},300)}E.find("polygon").attr("class","mapify-polygon")}function m(M,G){var F=f(G)[0];var I=d(F);var J=I["center top"];var L=M.outerWidth();var D=j.popOver.margin;if(B.width()-(D*2)<=L){L=B.width()-(D*2);M.css({maxWidth:L})}else{if(u.width()-(D*2)<=L){L=u.width()-(D*2);M.css({maxWidth:L})}else{M.css({maxWidth:""})}}M.css({marginLeft:-(L/2)});var H=0;if(u.width()<B.width()){var E=(J[0]-(L/2))-B.scrollLeft();if(E+L>(u.width()-D)){H=((E+L)-u.width())+D}else{if(E<D){H=E-D}}}else{var E=(J[0]-(L/2))-B.scrollLeft();if(E+L>(B.outerWidth()-D)){H=((E+L)-B.outerWidth())+D}else{if(E<D){H=E-D}}}if(J[1]-M.outerHeight()-D<0){J=I["center bottom"];M.addClass("mapify-to-bottom")}else{if(M.hasClass("mapify-to-bottom")){M.removeClass("mapify-to-bottom")
}}J[0]-=H;var K=H;if(H>((L/2)-(D*2))){K=(L/2)-(D*2)}else{if(H<-((L/2)-(D*2))){K=-(L/2)+(D*2)}}if(!M.hasClass("mapify-visible")){M.css({top:J[1],left:J[0],transition:"none"});w.css({marginLeft:K,transition:"none"})}clearTimeout(s);s=setTimeout(function(){var N=j.popOver.content(f(G),A);M.find(".mapify-popOver-content").html(N);if(M.hasClass("mapify-to-bottom")){M.css({marginTop:""});if(!M.hasClass("mapify-bottom")){w.css({marginLeft:H,transition:"none"})}M.addClass("mapify-bottom");M.removeClass("mapify-to-bottom")}else{if(M.hasClass("mapify-bottom")){w.css({marginLeft:H,transition:"none"})}M.removeClass("mapify-bottom");M.css({marginTop:-M.outerHeight()})}setTimeout(function(){M.css({top:J[1],left:J[0],transition:i}).addClass("mapify-visible");w.css({marginLeft:K,transition:l})},10)},100)}}a(r,A);f(A).bind("load.mapify",function(){a(r,A)})});return"mapified"};f.fn.scrollParent=function(){var j=this.css("position"),i=j==="absolute",k=this.parents().filter(function(){var l=f(this);if(i&&l.css("position")==="static"){return false}return(/(auto|scroll)/).test(l.css("overflow")+l.css("overflow-y")+l.css("overflow-x"))}).eq(0);return j==="fixed"||!k.length?f(this[0].ownerDocument||document):k};function h(l,n,k,o){var m=f(l).attr("data-coords").split(",");var i="";for(key in m){if(key%2==0){i+=(f(n).width()*(m[key]/100))}else{i+=","+(f(n).height()*(m[key]/100))+" "}}var j=k.find("polygon:eq("+f(l).index()+")");j.attr("points",i).attr("class",function(p,q){return q+" mapify-hover"});if(o!=""){j.attr("points",i).attr("class",function(p,q){return q+" "+o})}}function a(i,j){i.each(function(){var k=f(this).attr("data-coords").split(",");for(key in k){if(key%2==0){k[key]=(f(j).width()*(k[key]/100))}else{k[key]=(f(j).height()*(k[key]/100))}}f(this).attr("coords",k.toString())})}function d(k){var s=k.getAttribute("coords");var j=s.split(","),q=[];var r,o=maxX=parseInt(j[0],10),m=maxY=parseInt(j[1],10);for(var p=0,n=j.length;p<n;p++){r=parseInt(j[p],10);if(p%2==0){if(r<o){o=r}else{if(r>maxX){maxX=r}}}else{if(r<m){m=r}else{if(r>maxY){maxY=r}}}}o=o;maxX=maxX;m=m;maxY=maxY;centerX=parseInt((o+maxX)/2,10);centerY=parseInt((m+maxY)/2,10);q={"center top":{0:centerX,1:m},"center bottom":{0:centerX,1:maxY}};return(q)}}(jQuery));
$(".hoverlink").on("mouseover", function(e) {
    var num = this.id.match(/\d+$/)[0];
    $("#hover" + num).mouseover();
}).mouseout(function(e) {
    var num = this.id.match(/\d+$/)[0];
    $("#hover" + num).mouseout();
});
$("img[usemap]").mapify();